name: Continous Integration

on:
  push:
    branches:
      - "main"
      - "release/**"
      - "feature/**"

jobs:
  Versioning:
    name: Git Version
    uses: ./.github/workflows/git.yaml

  Testversion:
    name: Teste version
    runs-on: ubuntu-latest
    needs: Versioning

    steps:
      - run: |
          echo version: ${{ needs.versioning.outputs.version }}

  job1:
    runs-on: ubuntu-latest
    # Expose step outputs as job outputs
    outputs:
      output1: ${{ steps.step1.outputs.test }}
      output2: ${{ steps.step2.outputs.test }}
    steps:
    - id: step1
      run: echo "test=hello" >> "$GITHUB_OUTPUT"
    - id: step2
      run: echo "test=world" >> "$GITHUB_OUTPUT"
  job2:
    runs-on: ubuntu-latest
    needs: job1
    steps:
    - run: echo ${{needs.job1.outputs.output1}} ${{needs.job1.outputs.output2}}

  # build:
  #   name: .Net Building
  #   uses: ./.github/workflows/build.yaml
  #   needs: Versioning
  #   with:
  #     dotnet-version: "8.0.x"
  #     solution-name: household.buget.sln

  # docker:
  #   name: Docker Build and publish
  #   uses: ./.github/workflows/docker.yaml
  #   # needs: build
  #   with:
  #     username: leandroalves86
  #     context: ./src/Household.Budget/
  #     dockerfile: ./src/Household.Budget/Dockerfile
  #     version: ${{ needs.versioning.outputs.version }}
  #     solution-name: household.buget
  #   secrets:
  #     usertoken: ${{ secrets.DOCKERHUB_TOKEN }}
